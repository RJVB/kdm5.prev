include(MacroEnsureVersion)
macro_optional_find_package(NetworkManager)
    

macro_optional_find_package(BlueZ)
macro_log_feature(BLUEZ_FOUND "BlueZ" "BlueZ is the linux bluetooth subsystem" "http://www.bluez.org")

add_subdirectory( kcm )
add_subdirectory( solidshell )

IF("${CMAKE_SYSTEM}" MATCHES "Linux")
    add_subdirectory( hal )
    add_subdirectory( networking )
ENDIF("${CMAKE_SYSTEM}" MATCHES "Linux")

if (NETWORKMANAGER_FOUND)
   macro_ensure_version_range( "0.6.5" ${NETWORKMANAGER_VERSION} "0.7.0" NM_0_6)
   if (NM_0_6)
      add_subdirectory( networkmanager-0.6 )
      macro_log_feature(NM_0_6 "NetworkManager ${NETWORKMANAGER_VERSION}" "NetworkManager is a daemon for user controlled networking" "http://www.gnome.org/projects/NetworkManager")
   endif (NM_0_6)
   macro_ensure_version( "0.7.0" ${NETWORKMANAGER_VERSION} NM_0_7)
   if (NM_0_7)
      add_subdirectory( networkmanager-0.7 )
      macro_log_feature(NM_0_7 "NetworkManager ${NETWORKMANAGER_VERSION}" "NetworkManager is a daemon for user controlled networking" "http://www.gnome.org/projects/NetworkManager")
   endif (NM_0_7)
else(NETWORKMANAGER_FOUND)
      macro_log_feature(FALSE "NetworkManager (any version)" "NetworkManager is a daemon for user controlled networking" "http://www.gnome.org/projects/NetworkManager")
endif (NETWORKMANAGER_FOUND)
if (BLUEZ_FOUND)
	add_subdirectory( bluez )
endif (BLUEZ_FOUND)
